# 
```python
import os
from selenium import webdriver

# banana 분류기 할 때,
# driver = webdriver.Chrome(service=ChromeService(ChromeDriverManager().install())) 코드 썼는데 사용자 버전에 맞게 자동으로 드라이버 가져오는데 그 새 버전이 바뀌거나 아직 업데이트가 안된듯?

# chromedriver.exe 경로 지정하기
path = os.path.join(os.getcwd(), "chromedriver-win64/chromedriver.exe")

# 서비스를 생성하고 chromedriver의 경로를 지정합니다..
service = webdriver.chrome.service.Service(path)
# service 생성은 selenium version 3점대는 안됨. 4도 4.3까지?

# 지정된 서비스를 사용하여 Chrome 브라우저를 시작합니다.
driver = webdriver.Chrome(service=service)

# webdriver가 google 페이지에 접속하도록 명령
driver.get("http://www.google.co.kr")

# 페이지 제목을 확인하여 Google 사이트에 접속했는지 확인하기.
assert "Google" in driver.title
```

# 네이버 금융 최근 인기종목 5개 불러오기
```python
import os
from selenium import webdriver
from bs4 import BeautifulSoup
import time

def get_stock_info():
    # driver = webdriver.Chrome('/Users/cooju/Downloads/chromedriver')  # 여기에 실제 ChromeDriver 경로를 입력
    # driver = webdriver.Chrome('C:/Users/cooju/Downloads/chromedriver.exe')
    #driver = webdriver.Chrome('C:\\Users\\cooju\\Downloads\\chromedriver.exe')
    path = os.path.join(os.getcwd(), "chromedriver-win64/chromedriver.exe")
    # 서비스를 생성하고 chromedriver의 경로를 지정합니다..
    service = webdriver.chrome.service.Service(path)
    # 지정된 서비스를 사용하여 Chrome 브라우저를 시작합니다.
    driver = webdriver.Chrome(service=service)
    
    url = "https://finance.naver.com/sise/lastsearch2.nhn"
    driver.get(url)

    soup = BeautifulSoup(driver.page_source, 'lxml')

    data_rows = soup.find("table", attrs={"class":"type_5"}).find("tbody").find_all("tr")
    
    for idx, row in enumerate(data_rows):
        columns = row.find_all("td")
        if len(columns) <= 1:  # 의미없는 데이터 스킵
            continue
        data = [column.get_text().strip() for column in columns]
        print(f"종목명: {data[1]:10}, 현재가: {data[3]}, 전일대비: {data[4]}")
        
        if idx >= 6:  # 상위 5개만 출력
            break
    
    time.sleep(1)  
    driver.quit()

get_stock_info()
```

# 네이버 로그인
```python
from selenium import webdriver
from selenium.webdriver.common.by import By
from bs4 import BeautifulSoup
import time
import os

#chromedriver.exe 경로 지정하기
path = os.path.join(os.getcwd(), "chromedriver-win64/chromedriver.exe")
# 서비스를 생성하고 chromedriver의 경로를 지정합니다..
service = webdriver.chrome.service.Service(path)
# # 지정된 서비스를 사용하여 Chrome 브라우저를 시작합니다.
driver = webdriver.Chrome(service=service)
#driver = webdriver.Chrome(path)  # 여기에 실제 ChromeDriver 경로를 입력

url = "https://www.naver.com"
driver.get(url)

element = driver.find_element(By.CLASS_NAME,'MyView-module__link_login___HpHMW')

element.click()
```

```python
# 네이버 ID/PWD 입력
id = '******'
pw = '******'
```

```python
# 로그인 시 자동입력방지하기 위한 Captchar프로그램 실행을 방지하기 위해 직접 아이디와 패스워드값을 프로그램에 입력하는 것이 좋음
driver.execute_script("document.getElementById('id').value=\'" + id + "\'")
# element = driver.find_element(By.ID, "id")
# element.send_keys(id)
time.sleep(1)
# element = driver.find_element(By.ID, "pw")
# element.send_keys(pw)
driver.execute_script("document.getElementById('pw').value=\'" + pw + "\'")
time.sleep(1)
element = driver.find_element(By.CLASS_NAME,'btn_text')
element.click()
time.sleep(1)
element = driver.find_element(By.CLASS_NAME,'service_icon.type_mail')
element.click()
```
cf. 근데 네이버에서 봇인걸 잘 잡아내서 안됨.

```python
# 최근 열린 탭으로 전환
driver.switch_to.window(driver.window_handles[-1])

# 로딩 기다리기
time.sleep(5)
```

### 메일함 페이지 소스 가져오기
```python
from bs4 import BeautifulSoup

page_source = driver.page_source
soup = BeautifulSoup(page_source, 'html.parser')

mail_list = soup.select('div.mail_title')
mail_sender = soup.select('div.mail_sender')

cnt = 1
for i in mail_list:
    print(cnt)
    print('보낸 사람 : ', i.select_one('button').text)
    print('메일 제목 : ', i.select_one('a').text)
    cnt += 1
```