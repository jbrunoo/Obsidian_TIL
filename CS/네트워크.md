# 인터넷 네트워크

## 인터넷 통신
- 클라이언트와 서버 간의 통신 - 복잡한 인터넷 망을 거침. 
- how 규칙? -> IP 주소를 통해.

## IP(Internet Protocol)
- 지정한 IP주소(IP Address)에 데이터 전달.
- 패킷(Packet)이라는 통신 단위로 데이터 전달.
- IP 패킷 정보 : 출발지 IP, 목적지 IP, 기타 ... 적고 전송데이터

##### IP 프로토콜의 한계
- 비연결성 - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
- 비신뢰성 - 중간에 패킷이 사라지면? 패킷이 순서대로 안오면? - 보통 1500byte씩 끊어보냄.
- 프로그램 구분 - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면?

## TCP, UDP(IP 프로토콜의 한계)

- **인터넷 프로토콜 스택의 4계층**
	애플리케이션 계층 - HTTP, FTP
	전송 계층 - TCP, UDP
	인터넷 계층 - IP
	네트워크 인터페이스 계층(랜 카드, 랜 드라이버 등)

![[Pasted image 20231128105949.png]]
웹 공부에서 IP까지면 충분해서 이더넷 프레임(랜 카드에 등록된 맥 주소 등)은 따로 설명X


위에 IP 프로토콜에서 IP 패킷에 출발지 IP, 목적지 IP, 기타.. 값을 넣었다면
TCP 패킷에는 출발지 PORT, 목적지 PORT, 전송 제어, 순서, 검증 정보 등이 포함됨.


- **TCP 특징** - 전송 제어 프로토콜(Transmission Control Protocol)
	연결 지향 - TCP 3 way handshake (가상 연결) : 연결이 되었는지 알 수 있음.
		**connect, 연결 과정** (SYN : 접속 요청, ACK : 요청 수락)
		:  1. SYN(클라->서버)    2. SYN + ACK(서버->클라)    3. ACK(클라->서버)     4. 데이터 전송
		요즘은 최적화가 되어서 3. ACK 수행할 때 데이터 전송도 같이 함.
		++ 실제로 중간 서버들까지 연결이 됐는지는 모름. 논리적으로 연결이 됐구나 하는 것. 
	데이터 전달 보증 : 데이터가 누락되면 발신자가 알 수 있음.
		: 1. 데이터 전송(클라->서버)    2. 데이터 잘 받았음(서버->클라) 
	순서 보장
		: 1. 패킷1, 2, 3 순으로 전송    2. 패킷1, 3, 2 순으로 도착    3. 패킷 2부터 다시 보내
		물론 서버에서 최적화하여 3, 2 순을 바꿀 수 있겠지만 기본적인 process는 위와 같음.

즉 TCP는 신뢰할 수 있는 프로토콜로 현재는 대부분 TCP 사용.

- **UDP 특징** - 사용자 데이터그램 프로토콜(User Datagram Protocol)
	하얀 도화지에 비유(기능 거의 없음)
	연결 지향 - TCP 3 way handshake X
	데이터 전달 보증 X
	순서 보장 X
	데이터 전달 및 순서가 보장되지 않지만 단순하고 빠름.
	정리 : IP와 거의 같다. + PORT + 체크섬 정도 추가.
	필요 시 확장하려면 애플리케이션에서 추가 작업 필요.


- **PORT**
	같은 IP 내에서 프로세스 구분. ex) 게임 서버 연결, 화상 통화 통신, 웹 브라우저 요청 등
	0 ~ 65535 할당 가능.
	0 ~ 1023 : 잘 알려진 포트, 사용하지 않는 것이 좋음.
	FTP : 20, 21 / TELNET : 23, HTTP : 80, HTTPS : 443


- **DNS** (쉬운 개념) 서버
	도메인 네임 시스템(Domain Name System)
	like 전화번호부 같은 서버.
	도메인 명을 IP 주소로 변환.
	이유 : IP 주소를 기억하기 어려움, IP는 변경될 수 있음. 


### URI와 웹 브라우저 요청 흐름
- URI(Uniform Resource Identifier) - URL과 URN은 URI의 한 종류임.
	URI? URL? URN? - > [1.1.3 URI, URL and URN](https://www.ietf.org/rfc/rfc3986.txt) => IETF 대표적인 논란거리 스펙 사이트 
```
1.1.3.  URI, URL, and URN

   A URI can be further classified as a locator, a name, or both.  The
   term "Uniform Resource Locator" (URL) refers to the subset of URIs
   that, in addition to identifying a resource, provide a means of
   locating the resource by describing its primary access mechanism
   (e.g., its network "location").  The term "Uniform Resource Name"
   (URN) has been used historically to refer to both URIs under the
   "urn" scheme [RFC2141], which are required to remain globally unique
   and persistent even when the resource ceases to exist or becomes
   unavailable, and to any other URI with the properties of a name.

   An individual scheme does not have to be classified as being just one
   of "name" or "locator".  Instances of URIs from any given scheme may
   have the characteristics of names or locators or both, often
   depending on the persistence and care in the assignment of
   identifiers by the naming authority, rather than on any quality of
   the scheme.  Future specifications and related documentation should
   use the general term "URI" rather than the more restrictive terms
   "URL" and "URN" [RFC3305].
```
- 
	URI는 로케이터(locator), 이름(name) 또는 둘 다 추가로 분류될 수 있다.
	즉, URI는 리소스를 식별하는데 리소스의 위치냐 이름이냐 차이. 
	URL(Resource Locator) URN(Resource Name) 대부분 URL만 씀 URN은 그냥 있다 정도.
	![[Pasted image 20231128171058.png]]

- 단어 뜻
	Uniform : 리소스 식별하는 통일된 방식.
	Resource : 자원, URI로 식별할 수 있는 모든 것(제한X).
	Identifier : 다른 항목과 구분하는데 필요한 정보.
	URL vs URN
	위치는 변할 수 있지만 이름은 변하지 않는다.
	URN:ISBN:8960777331 -> 어떤 책의 isbn URN
	검색엔진에 나오나 실제 화면X. 즉, URN 이름만으로 실제 리소스를 찾는 방법은 보편화 되지 않음.

- #### URL - 아래는 URI와 동일하게 취급.
	전체 문법
	scheme://(userinfo@)host(:port)(/path)(?query)(#fragment)
	https://www.google.com:443/search?q=hello&hl=ko
	프로토콜 : https
	호스트 명: www.google.com
	포트 번호 : 443
	패스 : /search
	쿼리 파라미터 : q=hello&hl=ko

- **scheme**
	주로 프로토콜을 사용.
	프로토콜 : 어떤 방식으로 자원에 접근할 것인가 하는 약속 규칙.
	ex) http, https, ftp 등
	http는 80포트, https는 443 포트를 주로 사용. 포트는 생략 가능.
	https는 http에 보안 추가(HTTP Secure) 

- userinfo - 거의 사용하지 않음 ! 
	URL에 사용자 정보를 포함해서 인증. 

- host
	호스트 명으로 도메인 명 또는 IP 주소를 직접 사용 가능.

- port
	포트(PORT) / 접속 포트 / 일반적으로 생략, 생략 시 http는 80, https는 443.

- path
	리소스 경로(path), 계층적 구조.
	ex) /home/file1.jpg    |      /members     |      /members/100, /items/iphone12

- query
	key-value 형태.
	?로 시작, &로 추가 가능. ?keyA=valueA&keyB=valueB
	웹 서버에 제공하는 파라미터, 문자 형태라서 query parameter, query string 등으로 불림.

- fragment
	html 내부 북마크 등에 사용. ex) html 내부에서 중앙으로 이동하고 싶을 때.
	서버에 전송하는 정보는 아님.


### 웹 브라우저 요청 흐름

예시 주소 : https://www.google.com:443/search?q=hello&hl=ko

1. IP와 PORT를 확인 - 구글 DNS 조회, https이므로 port 생략 시 443
2. http 요청 메시지 생성.
	ex) GET /search?q=hello&hl=ko HTTP/1.1 Host: www.google.com
	